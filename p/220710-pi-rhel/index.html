<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="如何在树莓派上安装红帽 Linux"><title>树莓派安装 RHEL</title>
<link rel=canonical href=https://blog.kmtea.eu/p/220710-pi-rhel/><link rel=stylesheet href=/scss/style.min.2cde0d6ad43d9b540cf0c948c669e62ebee4bc9888606690f283e6fab5b821e5.css><meta property="og:title" content="树莓派安装 RHEL"><meta property="og:description" content="如何在树莓派上安装红帽 Linux"><meta property="og:url" content="https://blog.kmtea.eu/p/220710-pi-rhel/"><meta property="og:site_name" content="酷玛阁 | KumaTea's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Guide"><meta property="article:tag" content="Raspberry Pi"><meta property="article:tag" content="RHEL"><meta property="article:published_time" content="2022-07-10T04:00:00+08:00"><meta property="article:modified_time" content="2023-06-20T23:01:21+08:00"><meta property="og:image" content="https://blog.kmtea.eu/p/220710-pi-rhel/img/cover.jpg"><meta name=twitter:site content="@KumaTea0"><meta name=twitter:creator content="@KumaTea0"><meta name=twitter:title content="树莓派安装 RHEL"><meta name=twitter:description content="如何在树莓派上安装红帽 Linux"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.kmtea.eu/p/220710-pi-rhel/img/cover.jpg"><link rel="shortcut icon" href=//kmtea.eu/res/2206/avatar.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-P86D5805EG"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-P86D5805EG",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3876653977265938" crossorigin=anonymous></script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=//kmtea.eu/res/2206/avatar.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>酷玛阁 | KumaTea's Blog</a></h1><h2 class=site-description></h2></div></header><ol class=menu id=main-menu><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>关于</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>归档</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>搜索</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>联系</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#这个想法怎么来的>这个想法怎么来的</a></li><li><a href=#需求>需求</a></li><li><a href=#注册-red-hat-个人订阅>注册 Red Hat 个人订阅</a></li><li><a href=#安装-oracle-linux>安装 Oracle Linux</a><ol><li><a href=#ssd-与-sd卡>SSD 与 SD卡</a></li></ol></li><li><a href=#系统准备>系统准备</a><ol><li><a href=#更新-kernel-uek>更新 <code>kernel-uek</code></a></li></ol></li><li><a href=#补丁和运行-convert2rhel>补丁和运行 &ldquo;convert2rhel&rdquo;。</a><ol><li><a href=#修改配置>修改配置</a></li><li><a href=#手动运行-convert2rhel>手动运行 <code>convert2rhel</code></a></li></ol></li><li><a href=#绑定订阅>绑定订阅</a></li><li><a href=#替换-repo>替换 repo</a><ol><li><a href=#删除不需要的软件包>删除不需要的软件包</a></li><li><a href=#替换非-rhel-软件包>替换非 RHEL 软件包</a></li></ol></li><li><a href=#结论>结论</a></li><li><a href=#后记>后记</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/220710-pi-rhel/><img src=/p/220710-pi-rhel/img/cover_hufd19ec95588be1982487783a3a109fc2_244566_800x0_resize_q75_box.jpg srcset="/p/220710-pi-rhel/img/cover_hufd19ec95588be1982487783a3a109fc2_244566_800x0_resize_q75_box.jpg 800w, /p/220710-pi-rhel/img/cover_hufd19ec95588be1982487783a3a109fc2_244566_1600x0_resize_q75_box.jpg 1600w" width=800 height=400 loading=lazy alt="Featured image of post 树莓派安装 RHEL"></a></div><div class=article-details><header class=article-category><a href=/categories/guides/>Guides</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/220710-pi-rhel/>树莓派安装 RHEL</a></h2><h3 class=article-subtitle>如何在树莓派上安装红帽 Linux</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2022-07-10</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pen" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M4 20h3L19 8a1.5 1.5.0 00-3-3L4 17v3"/><line x1="15.25" y1="6.75" x2="17.25" y2="8.75"/><circle cx="18" cy="18" r="4"/><path d="M18 16.496V18l1 1"/></svg><time class=article-lastmod>06-20</time></div></footer></div></header><section class=article-content><h1 id=树莓派安装-rhel>树莓派安装 RHEL</h1><blockquote><p>This tutorial is <a class=link href=https://github.com/KumaTea/pi-rhel target=_blank rel=noopener>originally written in English here</a></p></blockquote><h2 id=这个想法怎么来的>这个想法怎么来的</h2><p>大概是 <a class=link href=https://the-report.cloud/ibms-red-hat-just-killed-centos-as-we-know-it-with-centos-stream-stability-goes-out-of-the-door target=_blank rel=noopener>鲨了 CentOS</a> 的良心不安，
Red Hat 去年宣布 <a class=link href=https://developers.redhat.com/articles/faqs-no-cost-red-hat-enterprise-linux target=_blank rel=noopener>RHEL 个人订阅白送了</a> 。
也就是现在家用红帽 Linux 不要钱了！</p><p>我囸，有 RHEL 用，谁还玩 CentOS?</p><p>但是我没机器来玩 (P.S. 写的时候有了嘿嘿)，
手头就剩下一块树莓派 4B 🥺</p><p>于是开始搜索教程，但 Bing 直接给我当头一棒：</p><p><img src=/p/220710-pi-rhel/img/002-bing.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/002-bing_hu1bf9fdbf4e80d2d0349c886fa6bc27fe_230960_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/002-bing_hu1bf9fdbf4e80d2d0349c886fa6bc27fe_230960_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=Bing class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>本来准备放弃了， 结果意外发现，
<a class=link href=https://www.oracle.com/linux target=_blank rel=noopener>Oracle Linux</a> ，
一个红帽Linux的衍生版本，
(<del>对，就那个拒了我100多次注册云服务的万恶的 Oracle</del>)
有发布 <a class=link href=https://www.oracle.com/linux/downloads/linux-arm-downloads.html target=_blank rel=noopener>适用于树莓派 4B、400和3B/+ 的固件</a> 耶！</p><p><img src=/p/220710-pi-rhel/img/003-oracle.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/003-oracle_hu1cffe0560b536722807f95d64275a610_181938_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/003-oracle_hu1cffe0560b536722807f95d64275a610_181938_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt="Oracle Linux for Pi" class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>搜了下，大概是唯一支持树莓派的 RHEL 发行版了。</p><p>花了几天摸索出一个奇技淫巧，玩一波偷梁换柱，
达到在树莓派上安装 RHEL 的方法，简述一下。</p><h2 id=需求>需求</h2><ul><li>Raspberry Pi 4B, 400或3B/+<ul><li>仅在4B上测试成功</li></ul></li><li>一个系统盘<ul><li>强烈建议使用硬盘盒转接 SSD!!!</li></ul></li><li>Red Hat 个人订阅</li><li>科学或者魔法上网</li></ul><h2 id=注册-red-hat-个人订阅>注册 Red Hat 个人订阅</h2><p>来这里 <a class=link href=https://developers.redhat.com/register target=_blank rel=noopener>注册 Red Hat Individual Subscription</a> 。</p><p>注册完了记得看下 <a class=link href=https://access.redhat.com/management/subscriptions target=_blank rel=noopener>你的管理页面</a> 有没有东西：</p><p><img src=/p/220710-pi-rhel/img/004-rh-sub.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/004-rh-sub_hu9c05354e5fcc88de92760623c46f5beb_172116_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/004-rh-sub_hu9c05354e5fcc88de92760623c46f5beb_172116_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=订阅 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>等下要从 RHEL 的 repo 中更新软件包，所以这步不能省。</p><h2 id=安装-oracle-linux>安装 Oracle Linux</h2><p>首先 <a class=link href=https://www.oracle.com/linux/downloads/linux-arm-downloads.html target=_blank rel=noopener>下载 Oracle Linux</a> 。</p><p>然后找个你喜欢的刷写工具。
一般 <a class=link href="https://www.raspberrypi.com/software/#:~:text=Pi%20OS%20using-,Raspberry%C2%A0Pi%C2%A0Imager,-Raspberry%20Pi%20Imager" target=_blank rel=noopener>Raspberry Pi Imager</a>
就好了，但我更喜欢 <a class=link href=https://etcher.io target=_blank rel=noopener>Etcher</a> 。</p><p>下载的图像压缩成 <code>xz</code> 格式了，但不用解压，直接开刷！</p><p><img src=/p/220710-pi-rhel/img/005-flash.jpg width=1205 height=759 srcset="/p/220710-pi-rhel/img/005-flash_hu4e807e311aee9e62295d120367e15e2d_43632_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/005-flash_hu4e807e311aee9e62295d120367e15e2d_43632_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=Flashing class=gallery-image data-flex-grow=158 data-flex-basis=381px></p><h3 id=ssd-与-sd卡>SSD 与 SD卡</h3><p>Oracle Linux 的根文件系统 (rootfs) 是 <code>btrfs</code> ，
卡得出奇，卡的批爆！合起来写炸了我5个内存卡和U盘！就为了这篇！
所以别用内存卡！用固态！！！</p><p>或者可以考虑下换成 <code>f2fs</code> 。</p><p>然后接上树莓派，插电，开机！</p><p>进入路由的 DHCP 客户端页面，找到 IP 地址，刚出来那个。</p><p><img src=/p/220710-pi-rhel/img/006-dhcp.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/006-dhcp_hu6867aee3c0d6353764893a28a45a0657_143718_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/006-dhcp_hu6867aee3c0d6353764893a28a45a0657_143718_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=DHCP class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p><code>ssh</code> 连上，用户名 <code>root</code> ，密码 <code>oracle</code> 。</p><p><img src=/p/220710-pi-rhel/img/007-first-ssh.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/007-first-ssh_hud4c8633c4ba87a99fad395d606c94804_251950_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/007-first-ssh_hud4c8633c4ba87a99fad395d606c94804_251950_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=SSH class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h2 id=系统准备>系统准备</h2><p>###扩展分区</p><p>解压缩后的固件大小约为 3.89GB ，装完了剩下大约300MB。
这点地方塞牙缝 (<code>dnf update</code>) 都不够，先要用 <code>parted</code> 扩展分区。</p><p>没自带，先安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf install -y parted
</span></span></code></pre></td></tr></table></div></div><blockquote><p>不用先<code>dnf update</code></p></blockquote><p><img src=/p/220710-pi-rhel/img/008-install-parted.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/008-install-parted_hud4c8633c4ba87a99fad395d606c94804_237172_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/008-install-parted_hud4c8633c4ba87a99fad395d606c94804_237172_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=安装parted class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>然后开搞：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>parted /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># print</span>
</span></span><span class=line><span class=cl><span class=c1># resizepart 3</span>
</span></span><span class=line><span class=cl><span class=c1># q</span>
</span></span><span class=line><span class=cl>btrfs filesystem resize max /
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/009-parted.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/009-parted_hud4c8633c4ba87a99fad395d606c94804_162638_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/009-parted_hud4c8633c4ba87a99fad395d606c94804_162638_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=parted class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h3 id=更新-kernel-uek>更新 <code>kernel-uek</code></h3><p>要留的唯一一个软件包是 <code>kernel-uek</code> 。
全称 <a class=link href=https://docs.oracle.com/en/operating-systems/uek/ target=_blank rel=noopener>Unbreakable Enterprise Kernel</a> ，
是 Oracle 搞的 Linux 内核。</p><p>为什么留，因为只有 Oracle Linux 支持树莓派，当然只有它的内核能用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf update -y kernel-uek
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/010-kernel-uek.jpg width=1092 height=482 srcset="/p/220710-pi-rhel/img/010-kernel-uek_hu55d4fd3a8cc485e66c3fe717b6c45a2e_49710_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/010-kernel-uek_hu55d4fd3a8cc485e66c3fe717b6c45a2e_49710_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=更新kernel-uek class=gallery-image data-flex-grow=226 data-flex-basis=543px></p><h2 id=补丁和运行-convert2rhel>补丁和运行 &ldquo;convert2rhel&rdquo;。</h2><p>开始偷梁换柱之前先看看 <code>os-release</code> 怀念一下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat /etc/os-release
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/011-os-release.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/011-os-release_hu3008f0d080743e4925b2d13230480b95_140984_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/011-os-release_hu3008f0d080743e4925b2d13230480b95_140984_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=os-release class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>###安装<code>convert2rhel</code>。</p><p>参照 <a class=link href=https://www.redhat.com/en/blog/introduction-convert2rhel-now-officially-supported-convert-rhel-systems-rhel target=_blank rel=noopener>换到 Red Hat 吧</a> ，
第一步是添加证书和仓库。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ref: https://www.redhat.com/en/blog/introduction-convert2rhel-now-officially-supported-convert-rhel-systems-rhel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -o /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release https://www.redhat.com/security/data/fd431d51.txt
</span></span><span class=line><span class=cl>curl --create-dirs -o /etc/rhsm/ca/redhat-uep.pem https://ftp.redhat.com/redhat/convert2rhel/redhat-uep.pem
</span></span><span class=line><span class=cl>curl -o /etc/yum.repos.d/convert2rhel.repo https://ftp.redhat.com/redhat/convert2rhel/8/convert2rhel.repo
</span></span></code></pre></td></tr></table></div></div><p>然后安装 <code>convert2rhel</code> ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf install -y convert2rhel
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/012-install-c2r.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/012-install-c2r_hud4c8633c4ba87a99fad395d606c94804_290009_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/012-install-c2r_hud4c8633c4ba87a99fad395d606c94804_290009_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt="安装 convert2rhel" class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h3 id=修改配置>修改配置</h3><p>由于 RHEL 没有正式支持树莓派，它的转换工具也不会包含我们要用的配置。
硬转就会。。。</p><p><img src=/p/220710-pi-rhel/img/013-c2r-errors.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/013-c2r-errors_hud4c8633c4ba87a99fad395d606c94804_238543_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/013-c2r-errors_hud4c8633c4ba87a99fad395d606c94804_238543_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt="convert2rhel errors" class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>但是可以偷懒，只要改下 <code>x86_64</code> 的配置就行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cp /usr/share/convert2rhel/configs/oracle-8-x86_64.cfg /usr/share/convert2rhel/configs/oracle-8-aarch64.cfg
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/rhel-8-for-x86_64/rhel-8-for-aarch64/g&#39;</span> /usr/share/convert2rhel/configs/oracle-8-aarch64.cfg
</span></span><span class=line><span class=cl><span class=c1># sed -i &#39;s/-rpms/-beta-rpms/g&#39; /usr/share/convert2rhel/configs/oracle-8-aarch64.cfg</span>
</span></span><span class=line><span class=cl><span class=c1># sed -i &#34;s/checks.perform_pre_checks()/loggerinst.task(&#39;SKIP CHECKS&#39;)  # checks.perform_pre_checks()/g&#34; /usr/lib/python3.6/site-packages/convert2rhel/main.py</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/json-c.x86_64/json-c.aarch64/g&#39;</span> /usr/lib/python3.6/site-packages/convert2rhel/subscription.py
</span></span></code></pre></td></tr></table></div></div><p>x86 上 <code>convert2rhel</code> 会搞定证书，
但是因为是树莓派，我们要自己搞。</p><p><a class=link href=https://access.redhat.com/labs/rhpc/ target=_blank rel=noopener><strong>红帽产品证书</strong></a></p><p><img src=/p/220710-pi-rhel/img/014-rhel-cert.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/014-rhel-cert_hue59811b2a7f4a57ed1607a99a5911f8b_113405_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/014-rhel-cert_hue59811b2a7f4a57ed1607a99a5911f8b_113405_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=RHEL证书 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>在 <em>Choose your product</em> 中选择 <code>Red Hat Enterprise Linux</code>,
找到 <strong><code>Red Hat Enterprise Linux for ARM 64</code></strong>,
选好版本和架构并下载，把证书传到树莓上运行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># cp /path/to/cert/script /tmp/Red_Hat_Product_Certificate.sh</span>
</span></span><span class=line><span class=cl>chmod +x /tmp/Red_Hat_Product_Certificate.sh
</span></span><span class=line><span class=cl>bash /tmp/Red_Hat_Product_Certificate.sh
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/015-add-cert.jpg width=1070 height=583 srcset="/p/220710-pi-rhel/img/015-add-cert_huee524f3abebe25d7a7dd006f09d4a411_68080_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/015-add-cert_huee524f3abebe25d7a7dd006f09d4a411_68080_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt="add cert" class=gallery-image data-flex-grow=183 data-flex-basis=440px></p><h3 id=手动运行-convert2rhel>手动运行 <code>convert2rhel</code></h3><p>不能直接运行 <code>convert2rhel</code> ，
因为它写的时候也没想到会有人在树莓派上跑。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>source</span> /etc/os-release <span class=o>&amp;&amp;</span> python3 -c <span class=s2>&#34;from convert2rhel import main, subscription, systeminfo; main.initialize_logger(&#39;convert2rhel.log&#39;, &#39;/var/log/convert2rhel&#39;); systeminfo.RELEASE_VER_MAPPING[&#39;</span><span class=nv>$VERSION</span><span class=s2>&#39;] = &#39;</span><span class=nv>$VERSION</span><span class=s2>&#39;; systeminfo.system_info.resolve_system_info(); subscription.download_rhsm_pkgs()&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>成功了大概会是这样：</p><p><img src=/p/220710-pi-rhel/img/016-manual-c2r.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/016-manual-c2r_hud4c8633c4ba87a99fad395d606c94804_308127_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/016-manual-c2r_hud4c8633c4ba87a99fad395d606c94804_308127_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=手动运行 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>然后安装刚刚下载的软件包：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> /usr/share/convert2rhel/subscription-manager
</span></span><span class=line><span class=cl>dnf install -y <span class=k>$(</span>ls <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/019-local-pkgs.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/019-local-pkgs_hud4c8633c4ba87a99fad395d606c94804_274527_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/019-local-pkgs_hud4c8633c4ba87a99fad395d606c94804_274527_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=安装本地软件包 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h2 id=绑定订阅>绑定订阅</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>subscription-manager register
</span></span></code></pre></td></tr></table></div></div><h2 id=替换-repo>替换 repo</h2><p>先鸟尽弓藏兔死狗烹。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mv /etc/yum.repos.d/convert2rhel.repo /etc/yum.repos.d/convert2rhel.repo.bak
</span></span><span class=line><span class=cl>mv /etc/yum.repos.d/oracle-linux-ol8.repo /etc/yum.repos.d/oracle-linux-ol8.repo.bak
</span></span><span class=line><span class=cl>dnf clean all
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/020-disable-repos.jpg width=1920 height=613 srcset="/p/220710-pi-rhel/img/020-disable-repos_hu3008f0d080743e4925b2d13230480b95_126091_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/020-disable-repos_hu3008f0d080743e4925b2d13230480b95_126091_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt="禁用 repos" class=gallery-image data-flex-grow=313 data-flex-basis=751px></p><h3 id=删除不需要的软件包>删除不需要的软件包</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm
</span></span><span class=line><span class=cl>subscription-manager repos --enable <span class=s2>&#34;codeready-builder-for-rhel-8-</span><span class=k>$(</span>arch<span class=k>)</span><span class=s2>-rpms&#34;</span>
</span></span><span class=line><span class=cl>dnf remove convert2rhel -y
</span></span><span class=line><span class=cl>dnf remove oraclelinux-release oraclelinux-release-el8 <span class=o>||</span> rpm -e --nodeps oraclelinux-release oraclelinux-release-el8
</span></span></code></pre></td></tr></table></div></div><p>###重新安装本地安装的软件包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> /usr/share/convert2rhel/subscription-manager
</span></span><span class=line><span class=cl>dnf reinstall -y <span class=k>$(</span>ls <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/.rpm//g&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ~
</span></span><span class=line><span class=cl>rm -rvf /usr/share/convert2rhel
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/022-reinst-local-pkgs.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/022-reinst-local-pkgs_hud4c8633c4ba87a99fad395d606c94804_312644_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/022-reinst-local-pkgs_hud4c8633c4ba87a99fad395d606c94804_312644_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=替换本地软件包 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h3 id=替换非-rhel-软件包>替换非 RHEL 软件包</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf install -y redhat-lsb
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/023-install-lsb.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/023-install-lsb_hud4c8633c4ba87a99fad395d606c94804_313147_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/023-install-lsb_hud4c8633c4ba87a99fad395d606c94804_313147_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=redhat-lsb class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dnf reinstall setup
</span></span><span class=line><span class=cl>dnf distro-sync
</span></span><span class=line><span class=cl>dnf update -y
</span></span><span class=line><span class=cl>dnf reinstall <span class=k>$(</span>dnf list --installed <span class=p>|</span> grep ol8 <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>dnf reinstall <span class=k>$(</span>dnf list --installed <span class=p>|</span> grep anaconda <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>dnf reinstall <span class=k>$(</span>dnf list --installed <span class=p>|</span> grep commandline <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/220710-pi-rhel/img/024-replace-ol8.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/024-replace-ol8_hu5237e37182aac5388f621737ed9d4c69_367837_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/024-replace-ol8_hu5237e37182aac5388f621737ed9d4c69_367837_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=替换非rhel软件包 class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h2 id=结论>结论</h2><p>家人们看看 <code>neofetch</code> 吧</p><p><img src=/p/220710-pi-rhel/img/001-neofetch.jpg width=1920 height=1080 srcset="/p/220710-pi-rhel/img/001-neofetch_hu0441c9d4ee1e98645c73eac8ee6ec549_254511_480x0_resize_q75_box.jpg 480w, /p/220710-pi-rhel/img/001-neofetch_hu0441c9d4ee1e98645c73eac8ee6ec549_254511_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=neofetch class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h2 id=后记>后记</h2><p>RHEL 9 出了，但是懒得折腾了，教程写了开摆。</p><p>不会真的有人会有和我一样的脑洞吧？？？</p><p>以及这篇尽量口语化了，如果你英语很彳亍，真想搞还是建议看看上面的英文链接。
虽然我英语是工地水平，但是大概还是比看这篇好理解一点。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/guide/>Guide</a>
<a href=/tags/raspberry-pi/>Raspberry Pi</a>
<a href=/tags/rhel/>RHEL</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/231013-saas/><div class=article-image><img src=/p/231013-saas/img/cover.3f827767f29dbe88cf45e19edbd287ac_huebbfad1edfa8e198fe68a27ac6a615ca_46560_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post SaaS 平台 Python 应用部署实战" data-key=231013-saas data-hash="md5-P4J3Z/KdvojPReGe29KHrA=="></div><div class=article-details><h2 class=article-title>SaaS 平台 Python 应用部署实战</h2></div></a></article><article class=has-image><a href=/p/230718-modem-decrypt/><div class=article-image><img src=/p/230718-modem-decrypt/img/cover.8b7cc96a6fbdd9b4aa9af57a6717b0b8_hu9e2107f7c46e82182743b850ca0770b6_37874_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 诺基亚贝尔光猫宽带密码破解提取" data-key=230718-modem-decrypt data-hash="md5-i3zJam+92bSqmvV6ZxewuA=="></div><div class=article-details><h2 class=article-title>诺基亚贝尔光猫宽带密码破解提取</h2></div></a></article><article class=has-image><a href=/p/230617-apple-pay/><div class=article-image><img src=/p/230617-apple-pay/img/err-invalid.c271f62475a3b3c34dda6e5a8ffae6df_huf3c10c93b5b3d869ba6a8349297c4b96_19310_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post Apple Pay 绑卡失败原因速查" data-key=230617-apple-pay data-hash="md5-wnH2JHWjs8NN2m5aj/rm3w=="></div><div class=article-details><h2 class=article-title>Apple Pay 绑卡失败原因速查</h2></div></a></article><article class=has-image><a href=/p/221227-pve-openwrt/><div class=article-image><img src=/p/221227-pve-openwrt/img/cover.a14de8c6d6b26ca4792b753f58493704_huac6fe951059aa453777e1cd724557934_72093_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post PVE 更新 OpenWrt 教程" data-key=221227-pve-openwrt data-hash="md5-oU3oxtaybKR5K3U/WEk3BA=="></div><div class=article-details><h2 class=article-title>PVE 更新 OpenWrt 教程</h2></div></a></article><article class=has-image><a href=/p/221003-glibc-openwrt-en/><div class=article-image><img src=/p/221003-glibc-openwrt/img/cover.jpg loading=lazy data-key=221003-glibc-openwrt-en data-hash=/p/221003-glibc-openwrt/img/cover.jpg></div><div class=article-details><h2 class=article-title>Add glibc to OpenWrt</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=KumaTea/blog data-repo-id=R_kgDOHa9iHQ data-category=Q&amp;A data-category-id=DIC_kwDOHa9iHc4CXYZJ data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"preferred_color_scheme":"preferred_color_scheme")}})()</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2023 酷玛阁 | KumaTea's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>